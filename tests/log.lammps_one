LAMMPS (11 Aug 2017)
# 3d Lennard-Jones fluid
# Validate with https://mmlapps.nist.gov/srs/LJ_PURE/md.htm

variable        density equal 0.776
variable        Nmols equal 500
variable L equal (${Nmols}/${density})^(1.0/3.0)
variable L equal (500/${density})^(1.0/3.0)
variable L equal (500/0.776)^(1.0/3.0)

# Initialize simulation
clear
units		lj      # Units type: Lennard-Jones
dimension 3         # 3D simulation
boundary p p p      # Periodic boundary conditions in all directions
atom_style	atomic  # Atom style: atoms

# Create atoms
region		box block 0 ${L} 0 ${L} 0 ${L}   # Specify simulation box dimensions, in # of atoms
region		box block 0 8.63712943023425 0 ${L} 0 ${L}   
region		box block 0 8.63712943023425 0 8.63712943023425 0 ${L}   
region		box block 0 8.63712943023425 0 8.63712943023425 0 8.63712943023425   
create_box	1 box                   # Create the simulation box, 1 type of atom, in box
Created orthogonal box = (0 0 0) to (8.63713 8.63713 8.63713)
  1 by 1 by 1 MPI processor grid
create_atoms	1 random ${Nmols} 12345 NULL               # Fill entire simulation box with atoms of type 1
create_atoms	1 random 500 12345 NULL               
Created 500 atoms
mass		1 1.0                   # Specify mass of atom type 1

# Force field
pair_style	lj/cut 3.0              # Use truncated Lennard-Jones potential
pair_modify tail yes                # with long range corrections
pair_coeff	1 1 1.0 1.0 3.0         # and specified coefficients and cutoff

# Relax the configuration
minimize 1.e-4 1.e-4 100 1000
WARNING: Using 'neigh_modify every 1 delay 0 check yes' setting during minimization (../min.cpp:168)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 6 6 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.279 | 4.279 | 4.279 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            0 9.3921912e+09            0 9.3921912e+09 2.9153386e+10 
     100            0    -6.864784            0    -6.864784   -2.6596382 
Loop time of 0.175606 on 1 procs for 100 steps with 500 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
         9392191223.25     -6.85981368798     -6.86478396675
  Force two-norm initial, final = 5.08362e+14 29.3202
  Force max component initial, final = 2.12942e+14 7.91411
  Final line search alpha, max atom move = 0.0107516 0.0850894
  Iterations, force evaluations = 100 190

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13237    | 0.13237    | 0.13237    |   0.0 | 75.38
Neigh   | 0.037636   | 0.037636   | 0.037636   |   0.0 | 21.43
Comm    | 0.0033391  | 0.0033391  | 0.0033391  |   0.0 |  1.90
Output  | 2.3842e-05 | 2.3842e-05 | 2.3842e-05 |   0.0 |  0.01
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00224    |            |       |  1.28

Nlocal:    500 ave 500 max 500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    2290 ave 2290 max 2290 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    30149 ave 30149 max 30149 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 30149
Ave neighs/atom = 60.298
Neighbor list builds = 36
Dangerous builds = 0

# Initial atom velocities
velocity	all create 0.95 54321   # Last 2 arguments are temperature and random seed

# Neighbor lists
neighbor	0.3 bin                 # Padding of neighbors beyond the cutoff
neigh_modify	every 20 delay 0 check no

# Other settings
fix		1 all nve                   # NVE ensemble
timestep 0.002

# Output settings
# Save the time evolution of the positions of all of the atoms
#dump		id all atom 100 dump.LJ_fluid

# Compute and save the radial distribution function, with specified # of bins
compute myRDF all rdf 50
fix 2 all ave/time 4 10 500 c_myRDF[*] file out.rdf mode vector

# Specify how often to save thermodynamic properties and which ones. Goes into log.lammps
thermo		100
thermo_style one
#thermo_style custom step time pe ke etotal temp press

# Run simulation for specified number of time steps
run		20000
Neighbor list info ...
  update every 20 steps, delay 0 steps, check no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 6 6 6
  2 neighbor lists, perpetual/occasional/extra = 1 1 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) compute rdf, occasional, copy from (1)
      attributes: half, newton on
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 2.654 | 2.654 | 2.654 Mbytes
Step Temp E_pair E_mol TotEng Press 
     100         0.95    -6.864784            0    -5.442634   -1.9239126 
     200   0.49112169   -6.1748264            0   -5.4396172  0.048962253 
     300   0.48657108   -6.1649882            0   -5.4365913    -0.845993 
     400   0.46466846   -6.1297228            0   -5.4341141   -1.3517964 
     500   0.45182478   -6.1092728            0   -5.4328911    -1.582123 
     600   0.44082606   -6.0926473            0   -5.4327307   -1.6344987 
     700   0.44301647   -6.0972134            0   -5.4340178    -1.469046 
     800   0.45398263   -6.1138606            0   -5.4342486   -1.4857301 
     900   0.45072189    -6.108689            0   -5.4339583   -1.5940823 
    1000   0.44344001   -6.0965367            0    -5.432707   -1.6583668 
    1100   0.44617646   -6.1000525            0   -5.4321264   -1.8053825 
    1200   0.42209725   -6.0637985            0   -5.4319189   -1.6560031 
    1300   0.44239009   -6.0944248            0   -5.4321668   -1.7677356 
    1400   0.44160641   -6.0939491            0   -5.4328643   -1.7576832 
    1500    0.4532444    -6.110995            0   -5.4324881   -1.7732698 
    1600   0.43183731   -6.0793248            0   -5.4328644   -1.5667665 
    1700   0.45157802   -6.1094719            0   -5.4334596   -1.6734802 
    1800   0.45338605   -6.1122404            0   -5.4335215   -1.5557495 
    1900   0.45671128   -6.1178946            0   -5.4341978   -1.5370128 
    2000   0.45256855   -6.1117172            0    -5.434222   -1.5813922 
    2100   0.44299522   -6.0964364            0   -5.4332725     -1.62256 
    2200   0.43623297   -6.0854831            0   -5.4324424   -1.6273482 
    2300   0.46373963   -6.1272741            0   -5.4330559   -1.8172068 
    2400    0.4456689   -6.1004876            0   -5.4333212   -1.6752224 
    2500    0.4601393   -6.1218126            0   -5.4329841   -1.7339212 
    2600   0.44126092   -6.0936413            0   -5.4330737   -1.6253866 
    2700    0.4356117   -6.0853885            0   -5.4332778   -1.5681409 
    2800   0.45846953   -6.1196894            0   -5.4333605   -1.8089991 
    2900   0.47231172   -6.1408747            0    -5.433824   -1.7761547 
    3000   0.43590132   -6.0866952            0   -5.4341509   -1.4646214 
    3100   0.43847495   -6.0914332            0   -5.4350362   -1.3376455 
    3200    0.4847016   -6.1611931            0   -5.4355948   -1.5958455 
    3300   0.46200061   -6.1265883            0   -5.4349734    -1.405491 
    3400   0.48111807   -6.1551238            0   -5.4348901    -1.530674 
    3500   0.48403881   -6.1597485            0   -5.4351424   -1.6107428 
    3600   0.47280606   -6.1423026            0   -5.4345119   -1.6475163 
    3700   0.45266919   -6.1112667            0   -5.4336209   -1.4608026 
    3800   0.43002546   -6.0787543            0   -5.4350061   -1.2810786 
    3900   0.46824861   -6.1355588            0   -5.4345906   -1.5495283 
    4000   0.46081555   -6.1250517            0   -5.4352108    -1.516908 
    4100   0.45490332   -6.1169591            0   -5.4359689   -1.3715807 
    4200   0.45336449   -6.1138223            0   -5.4351357   -1.4027146 
    4300   0.44851889   -6.1064711            0   -5.4350384    -1.380229 
    4400   0.45711415   -6.1195549            0    -5.435255     -1.34419 
    4500   0.46547337   -6.1324904            0   -5.4356768   -1.4238162 
    4600   0.44593629   -6.1036403            0   -5.4360737    -1.324055 
    4700   0.46574898   -6.1327233            0   -5.4354971    -1.409088 
    4800   0.47001285   -6.1394741            0   -5.4358649   -1.4994215 
    4900   0.47776833   -6.1512154            0   -5.4359962   -1.5670494 
    5000   0.45080947   -6.1109422            0   -5.4360804   -1.3098742 
    5100   0.47832982   -6.1524633            0   -5.4364036   -1.4156651 
    5200   0.44380477   -6.1005641            0   -5.4361884   -1.1191404 
    5300   0.44713401   -6.1056726            0   -5.4363129   -1.2213363 
    5400   0.43549899   -6.0886127            0   -5.4366707    -1.144188 
    5500   0.43468183   -6.0866782            0   -5.4359595   -1.1551471 
    5600   0.46062379   -6.1263123            0   -5.4367585   -1.1642622 
    5700   0.46525009   -6.1333319            0   -5.4368525   -1.1833662 
    5800   0.47029946   -6.1413952            0   -5.4373569   -1.1751186 
    5900   0.46795308     -6.13811            0   -5.4375842    -1.151591 
    6000   0.48437484   -6.1628105            0   -5.4377014   -1.1808719 
    6100   0.46659669   -6.1362467            0   -5.4377515   -1.0752799 
    6200   0.46752363   -6.1377434            0   -5.4378605   -1.0909853 
    6300   0.46924191   -6.1396948            0   -5.4372396   -1.2360804 
    6400   0.47742143   -6.1514801            0   -5.4367802   -1.1773561 
    6500   0.49046457   -6.1707782            0   -5.4365527   -1.2433945 
    6600   0.47920216    -6.154044            0   -5.4366784   -1.2364184 
    6700   0.47018264   -6.1404328            0   -5.4365694   -1.1995607 
    6800   0.49360275   -6.1754857            0   -5.4365624   -1.2789205 
    6900   0.46358576   -6.1316404            0   -5.4376525    -1.032048 
    7000   0.48403886   -6.1619955            0   -5.4373893   -1.1678602 
    7100   0.49047195   -6.1716338            0   -5.4373973   -1.1902794 
    7200   0.48586358   -6.1646735            0   -5.4373357   -1.1461955 
    7300   0.47919997   -6.1540745            0   -5.4367122    -1.274923 
    7400   0.47579594   -6.1494621            0   -5.4371956   -1.1666973 
    7500   0.47790308   -6.1519607            0   -5.4365398   -1.2862432 
    7600   0.47086087   -6.1409892            0   -5.4361105   -1.2987249 
    7700   0.46674748   -6.1344001            0   -5.4356791   -1.3608324 
    7800   0.46999189   -6.1390253            0   -5.4354475   -1.5085639 
    7900   0.44191483   -6.0973639            0   -5.4358174   -1.2266374 
    8000    0.4605809   -6.1255961            0   -5.4361065   -1.3729355 
    8100   0.46245809   -6.1285992            0   -5.4362995    -1.440893 
    8200   0.46551997   -6.1326947            0   -5.4358113   -1.5428651 
    8300   0.43960251   -6.0944338            0   -5.4363489   -1.3502289 
    8400   0.46179079   -6.1280569            0   -5.4367561   -1.3491026 
    8500   0.44342986   -6.1006627            0   -5.4368482   -1.1936435 
    8600    0.4653967   -6.1329373            0   -5.4362384   -1.3615374 
    8700   0.46567314   -6.1336417            0    -5.436529   -1.2919983 
    8800   0.47617384   -6.1492524            0   -5.4364201   -1.2880004 
    8900   0.47736021   -6.1518946            0   -5.4372864   -1.1047491 
    9000     0.466083   -6.1351038            0   -5.4373775   -1.1527513 
    9100   0.49092144   -6.1720078            0   -5.4370984    -1.263972 
    9200   0.49831649   -6.1825325            0   -5.4365527   -1.2657207 
    9300   0.49357031   -6.1755391            0   -5.4366643   -1.2642344 
    9400   0.47579582   -6.1488558            0   -5.4365895   -1.2804014 
    9500     0.481267   -6.1566262            0   -5.4361695   -1.3368148 
    9600   0.45534477   -6.1177764            0   -5.4361253   -1.2154414 
    9700   0.48717351   -6.1653281            0   -5.4360293    -1.359796 
    9800   0.46177926   -6.1281068            0   -5.4368232   -1.1844981 
    9900   0.46257781   -6.1287317            0   -5.4362527   -1.2324435 
   10000   0.47265826   -6.1434874            0    -5.435918   -1.3582182 
   10100   0.45838009   -6.1225377            0   -5.4363427   -1.2480831 
   10200   0.46289717   -6.1297859            0   -5.4368289   -1.1132051 
   10300   0.46416564   -6.1308213            0   -5.4359654   -1.2114042 
   10400   0.43426692   -6.0859961            0   -5.4358985   -1.1415925 
   10500   0.46096038   -6.1255023            0   -5.4354446   -1.3134528 
   10600   0.45522834   -6.1169381            0   -5.4354612   -1.3842325 
   10700   0.43518497   -6.0866118            0     -5.43514   -1.4394016 
   10800   0.43838668   -6.0912078            0   -5.4349429   -1.5212898 
   10900   0.44549964   -6.1012505            0   -5.4343376    -1.467408 
   11000   0.44101638   -6.0955132            0   -5.4353116   -1.4361206 
   11100   0.46470298   -6.1306032            0   -5.4349428   -1.5073953 
   11200    0.4701518   -6.1387818            0   -5.4349645   -1.4764112 
   11300   0.45034306   -6.1107789            0   -5.4366154   -1.2281323 
   11400   0.44877826   -6.1085201            0    -5.436699   -1.2022338 
   11500   0.47490979   -6.1475775            0   -5.4366375   -1.2075852 
   11600   0.47728715   -6.1510481            0   -5.4365492   -1.1969984 
   11700   0.45663341   -6.1198725            0   -5.4362923   -1.2599495 
   11800   0.45596755   -6.1187619            0   -5.4361784   -1.3144039 
   11900   0.45542298   -6.1174763            0   -5.4357081   -1.2491324 
   12000   0.45124543   -6.1106039            0   -5.4350895    -1.249422 
   12100   0.47830783   -6.1515117            0   -5.4354849   -1.3496844 
   12200   0.46659237   -6.1346584            0   -5.4361696   -1.3106183 
   12300   0.48241136   -6.1594434            0   -5.4372736   -1.2379782 
   12400   0.45125773   -6.1126824            0   -5.4371496   -1.0713634 
   12500   0.46269708   -6.1290081            0   -5.4363506   -1.1574259 
   12600   0.45786596   -6.1212468            0   -5.4358214   -1.2234246 
   12700   0.46454538   -6.1316191            0   -5.4361947   -1.3312004 
   12800   0.44433882   -6.1009426            0   -5.4357673   -1.2577075 
   12900     0.449578   -6.1091571            0   -5.4361388   -1.3254021 
   13000   0.47937908   -6.1533523            0   -5.4357218   -1.4768131 
   13100   0.46227547   -6.1274329            0   -5.4354066   -1.5786688 
   13200   0.45414753   -6.1142624            0   -5.4344035   -1.4708487 
   13300   0.45574261   -6.1164145            0   -5.4341678   -1.5606913 
   13400   0.45579027   -6.1170085            0   -5.4346905   -1.7023727 
   13500   0.47454222   -6.1446479            0   -5.4342582   -1.7596222 
   13600   0.45767546   -6.1194009            0   -5.4342607   -1.5477313 
   13700   0.45211328   -6.1111439            0   -5.4343303   -1.5295788 
   13800   0.43386389   -6.0840734            0   -5.4345791   -1.4872979 
   13900    0.4508029     -6.10797            0    -5.433118   -1.6380988 
   14000   0.45160745   -6.1097083            0    -5.433652   -1.7127903 
   14100   0.46505996    -6.130428            0   -5.4342332   -1.7352827 
   14200   0.45044275   -6.1084265            0   -5.4341137    -1.710754 
   14300   0.44641547   -6.1024456            0   -5.4341617   -1.6628738 
   14400    0.4526494   -6.1114642            0    -5.433848   -1.5577266 
   14500   0.44975233   -6.1074493            0     -5.43417   -1.5939683 
   14600   0.44790027   -6.1047458            0   -5.4342391   -1.5506542 
   14700   0.46885386    -6.136819            0   -5.4349448   -1.4174161 
   14800   0.46635943   -6.1342258            0   -5.4360858    -1.332282 
   14900   0.46546048   -6.1321629            0   -5.4353686   -1.3589897 
   15000   0.46650625   -6.1340843            0   -5.4357244   -1.3389844 
   15100   0.45315432   -6.1140446            0   -5.4356726   -1.3239833 
   15200   0.47431544   -6.1463163            0   -5.4362661   -1.4250833 
   15300   0.45216642   -6.1124841            0    -5.435591   -1.3539913 
   15400   0.45669076   -6.1186877            0   -5.4350217   -1.5158233 
   15500   0.44895208   -6.1068586            0   -5.4347774   -1.5637955 
   15600   0.43846095   -6.0905129            0   -5.4341368   -1.5528395 
   15700   0.48143139   -6.1550161            0   -5.4343134   -1.7736807 
   15800   0.43775303   -6.0899431            0   -5.4346269   -1.5102613 
   15900   0.44102592   -6.0950745            0   -5.4348587   -1.4199434 
   16000   0.43674608   -6.0882331            0   -5.4344243   -1.4294589 
   16100   0.45507455   -6.1161526            0    -5.434906   -1.6390075 
   16200   0.44032468   -6.0937822            0   -5.4346161    -1.598332 
   16300   0.43734114   -6.0887326            0   -5.4340329    -1.632954 
   16400   0.43818509   -6.0904204            0   -5.4344573   -1.6658842 
   16500   0.43348025   -6.0829358            0   -5.4340158   -1.5691137 
   16600    0.4454958   -6.1006806            0   -5.4337734   -1.5690188 
   16700   0.43115754   -6.0796408            0    -5.434198   -1.4152691 
   16800   0.45866576   -6.1209415            0   -5.4343189   -1.5827192 
   16900   0.46510551   -6.1309757            0   -5.4347127   -1.4605151 
   17000    0.4672486    -6.135119            0   -5.4356478   -1.2754902 
   17100   0.48460031   -6.1610903            0   -5.4356437   -1.2706648 
   17200    0.4763912   -6.1494463            0   -5.4362887   -1.2671146 
   17300   0.47989621   -6.1540643            0   -5.4356596   -1.3805322 
   17400   0.47121619   -6.1421146            0    -5.436704   -1.1991006 
   17500   0.46331668   -6.1293616            0   -5.4357765   -1.1519033 
   17600   0.47187707   -6.1421595            0   -5.4357596   -1.2947175 
   17700    0.4560158   -6.1180087            0   -5.4353531   -1.2610619 
   17800   0.46566151   -6.1325926            0   -5.4354973   -1.3580253 
   17900   0.46410966   -6.1302699            0   -5.4354978   -1.3834007 
   18000   0.46704895   -6.1346213            0   -5.4354491   -1.3314755 
   18100   0.46371584    -6.129643            0   -5.4354604   -1.4037752 
   18200   0.47157661   -6.1416995            0   -5.4357493   -1.5057099 
   18300   0.45809053   -6.1210263            0   -5.4352648   -1.4111268 
   18400   0.46156909   -6.1260826            0   -5.4351136   -1.4500573 
   18500   0.46046277   -6.1247297            0   -5.4354169   -1.3536022 
   18600    0.4716128   -6.1421764            0    -5.436172   -1.3788703 
   18700    0.4481317   -6.1077842            0    -5.436931   -1.1087257 
   18800   0.45710668   -6.1204588            0   -5.4361701    -1.236366 
   18900   0.44834431   -6.1070166            0   -5.4358452   -1.2695874 
   19000   0.47643738   -6.1484699            0   -5.4352432    -1.450947 
   19100   0.44894992   -6.1070953            0   -5.4350173   -1.3678755 
   19200   0.44526169   -6.1018008            0   -5.4352441   -1.2978672 
   19300    0.4334362   -6.0839996            0   -5.4351456    -1.133286 
   19400   0.45175007   -6.1116878            0    -5.435418   -1.2247461 
   19500   0.45460051   -6.1166029            0    -5.436066    -1.154898 
   19600   0.45159425   -6.1127809            0   -5.4367444   -1.2471727 
   19700   0.44548878   -6.1038229            0   -5.4369262    -1.160119 
   19800   0.43454638    -6.086416            0   -5.4359001   -1.2187048 
   19900   0.46821008   -6.1376752            0   -5.4367647   -1.3216651 
   20000   0.46364777   -6.1299254            0   -5.4358446   -1.2102197 
   20100   0.47275059   -6.1442731            0   -5.4365654   -1.3228038 
Loop time of 11.8777 on 1 procs for 20000 steps with 500 atoms

Performance: 290964.369 tau/day, 1683.822 timesteps/s
99.5% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.013     | 10.013     | 10.013     |   0.0 | 84.30
Neigh   | 1.1775     | 1.1775     | 1.1775     |   0.0 |  9.91
Comm    | 0.27846    | 0.27846    | 0.27846    |   0.0 |  2.34
Output  | 0.0075064  | 0.0075064  | 0.0075064  |   0.0 |  0.06
Modify  | 0.34645    | 0.34645    | 0.34645    |   0.0 |  2.92
Other   |            | 0.05512    |            |       |  0.46

Nlocal:    500 ave 500 max 500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    2189 ave 2189 max 2189 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    29973 ave 29973 max 29973 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 29973
Ave neighs/atom = 59.946
Neighbor list builds = 1000
Dangerous builds not checked
Total wall time: 0:00:12
